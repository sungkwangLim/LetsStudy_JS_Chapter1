<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="user-scalable=yes, initial-scale=1.0, maximum-scale=3.0, minimum-scale=1.0, width=device-width">
    <title>Document</title>
</head>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js" integrity="sha512-BNaRQnYJYiPSqHHDb58B0yaPfCu+Wgds8Gp/gU33kqBtgNS4tSPHuGibyoeqMV/TJlSKda6FXzoEyYGjTe+vXA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<style>
    #card_box {position: relative; width: 100%; max-width: 500px;}
    #card_box p {font-size: 25px; position: absolute; left: 0; width: 100%; text-align: center; z-index: 1; color: #fff;}
    #card_box img {max-width : 100%;}
</style>
<body>
    <div class="copy" id="card_box">
        <p>테스트입니다</p>
        <img id="end_img" src="test.png">
    </div>
    <!-- <canvas id="canvas"></canvas> -->
    <button type="button"><span>버튼</span></button>
    <script>
      // 이미지 로드
    //   function name2(){
    //     var img = new Image();
    //     img.src = "test.png";
    //     img.onload = function() {
    //         // 캔버스 생성
    //         var canvas = document.getElementById("canvas");
    //         canvas.width = img.width;
    //         canvas.height = img.height;
    
    //         // 캔버스에 이미지 그리기
    //         var ctx = canvas.getContext("2d");
    //         ctx.drawImage(img, 0, 0);
    
    //         // 텍스트 그리기
    //         ctx.font = "bold 24px sans-serif";
    //         ctx.fillStyle = "white";
    //         ctx.fillText("Hello, World!", 50, 50);
    
    //         // 이미지를 로컬에 저장
    //         var link = document.createElement("a");
    //         link.download = "example-with-text.png";
    //         link.href = canvas.toDataURL("image/png",0.5);
    //         link.click();
    //     }
    // }
        function name() {
            const card = document.querySelector('#card_box');
            const card_img = document.querySelector('#end_img');
            html2canvas(card, { removeContainer: true })
        .then(canvas => {
            // 캔버스에 이미지 그리기
            // canvas.width = card_img.width;
            // canvas.height = card_img.height;
            // var ctx = canvas.getContext("2d");
            // ctx.drawImage(card_img, 0, 0);
    
            // 텍스트 그리기
            // ctx.font = "bold 24px sans-serif";
            // ctx.fillStyle = "white";
            // ctx.fillText("Hello, World!", 50, 50);

            var image = canvas.toDataURL("image/png");
            var a = document.createElement('a')
            a.setAttribute('download', 'cass-equity-card.png')
            a.setAttribute('href', image);
            a.setAttribute('target', '_blank');
            a.click();
            canvas.remove()
        })      
        }
    document.querySelector('button').addEventListener('click',function(){
        name();
    });
    </script>
  </body>
</html>